var i,n,t,r=require("preact"),o=require("preact/hooks"),e=require("@preact/signals-core"),f="undefined"!=typeof window&&!!window.__PREACT_SIGNALS_DEVTOOLS__,u=[],a=[];e.effect(function(){i=this.N})();function c(i,n){r.options[i]=n.bind(null,r.options[i]||function(){})}function s(i){if(t)t();t=i&&i.S()}function v(i){var n=this,t=i.data,f=useSignal(t);f.value=t;var u=o.useMemo(function(){var i=n,t=n.__v;while(t=t.__)if(t.__c){t.__c.__$f|=4;break}var o=e.computed(function(){var i=f.value.value;return 0===i?0:!0===i?"":i||""}),u=e.computed(function(){return!Array.isArray(o.value)&&!r.isValidElement(o.value)}),a=e.effect(function(){this.N=y;if(u.value){var n=o.value;if(i.__v&&i.__v.__e&&3===i.__v.__e.nodeType)i.__v.__e.data=n}}),c=n.__$u.d;n.__$u.d=function(){a();c.call(this)};return[u,o]},[]),a=u[0],c=u[1];return a.value?c.peek():c.value}v.displayName="ReactiveTextNode";Object.defineProperties(e.Signal.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:v},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});c("__b",function(i,n){if(f&&"function"==typeof n.type)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();if("string"==typeof n.type){var t,r=n.props;for(var o in r)if("children"!==o){var u=r[o];if(u instanceof e.Signal){if(!t)n.__np=t={};t[o]=u;r[o]=u.peek()}}}i(n)});c("__r",function(i,t){if(f&&"function"==typeof t.type)window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(t);if(t.type!==r.Fragment){s();var o,u=t.__c;if(u){u.__$f&=-2;if(void 0===(o=u.__$u))u.__$u=o=function(i){var n;e.effect(function(){n=this});n.c=function(){u.__$f|=1;u.setState({})};return n}()}n=u;s(o)}i(t)});c("__e",function(i,t,r,o){if(f)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();s();n=void 0;i(t,r,o)});c("diffed",function(i,t){if(f&&"function"==typeof t.type)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();s();n=void 0;var r;if("string"==typeof t.type&&(r=t.__e)){var o=t.__np,e=t.props;if(o){var u=r.U;if(u)for(var a in u){var c=u[a];if(void 0!==c&&!(a in o)){c.d();u[a]=void 0}}else{u={};r.U=u}for(var v in o){var h=u[v],p=o[v];if(void 0===h){h=d(r,v,p,e);u[v]=h}else h.o(p,e)}}}i(t)});function d(i,n,t,r){var o=n in i&&void 0===i.ownerSVGElement,f=e.signal(t);return{o:function(i,n){f.value=i;r=n},d:e.effect(function(){this.N=y;var t=f.value.value;if(r[n]!==t){r[n]=t;if(o)i[n]=t;else if(null!=t&&(!1!==t||"-"===n[4]))i.setAttribute(n,t);else i.removeAttribute(n)}})}}c("unmount",function(i,n){if("string"==typeof n.type){var t=n.__e;if(t){var r=t.U;if(r){t.U=void 0;for(var o in r){var e=r[o];if(e)e.d()}}}}else{var f=n.__c;if(f){var u=f.__$u;if(u){f.__$u=void 0;u.d()}}}i(n)});c("__h",function(i,n,t,r){if(r<3||9===r)n.__$f|=2;i(n,t,r)});r.Component.prototype.shouldComponentUpdate=function(i,n){var t=this.__$u,r=t&&void 0!==t.s;for(var o in n)return!0;if(this.__f||"boolean"==typeof this.u&&!0===this.u){var e=2&this.__$f;if(!(r||e||4&this.__$f))return!0;if(1&this.__$f)return!0}else{if(!(r||4&this.__$f))return!0;if(3&this.__$f)return!0}for(var f in i)if("__source"!==f&&i[f]!==this.props[f])return!0;for(var u in this.props)if(!(u in i))return!0;return!1};function useSignal(i,n){return o.useState(function(){return e.signal(i,n)})[0]}var h="undefined"==typeof requestAnimationFrame?setTimeout:function(i){var n=function(){clearTimeout(t);cancelAnimationFrame(r);i()},t=setTimeout(n,35),r=requestAnimationFrame(n)},p=function(i){queueMicrotask(function(){queueMicrotask(i)})};function l(){e.batch(function(){var n;while(n=u.shift())i.call(n)})}function w(){if(1===u.push(this))(r.options.requestAnimationFrame||h)(l)}function _(){e.batch(function(){var n;while(n=a.shift())i.call(n)})}function y(){if(1===a.push(this))(r.options.requestAnimationFrame||p)(_)}exports.Signal=e.Signal;exports.batch=e.batch;exports.computed=e.computed;exports.effect=e.effect;exports.signal=e.signal;exports.untracked=e.untracked;exports.useComputed=function(i,t){var r=o.useRef(i);r.current=i;n.__$f|=4;return o.useMemo(function(){return e.computed(function(){return r.current()},t)},[])};exports.useSignal=useSignal;exports.useSignalEffect=function(i,n){var t=o.useRef(i);t.current=i;o.useEffect(function(){return e.effect(function(){this.N=w;return t.current()},n)},[])};//# sourceMappingURL=signals.js.map
