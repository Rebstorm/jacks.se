!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("preact")):"function"==typeof define&&define.amd?define(["exports","preact"],t):t((e||self).preactRenderToString={},e.preact)}(this,function(e,t){var r="__s",n="__c",o="__d",i="__s",a=/[\s\n\\/='"\0<>]/,s=/^(xlink|xmlns|xml)([A-Z])/,c=/^(?:accessK|auto[A-Z]|cell|ch|col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z])/,l=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,u=new Set(["draggable","spellcheck"]);function p(e){void 0!==e.__g?e.__g|=8:e[o]=!0}function f(e){void 0!==e.__g?e.__g&=-9:e[o]=!1}function d(e){return void 0!==e.__g?!!(8&e.__g):!0===e[o]}var h=/["&<]/;function v(e){if(0===e.length||!1===h.test(e))return e;for(var t=0,r=0,n="",o="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:o="&quot;";break;case 38:o="&amp;";break;case 60:o="&lt;";break;default:continue}r!==t&&(n+=e.slice(t,r)),n+=o,t=r+1}return r!==t&&(n+=e.slice(t,r)),n}var m={},g=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),_=/[A-Z]/g;function y(e){var t="";for(var r in e){var n=e[r];if(null!=n&&""!==n){var o="-"==r[0]?r:m[r]||(m[r]=r.replace(_,"-$&").toLowerCase()),i=";";"number"!=typeof n||o.startsWith("--")||g.has(o)||(i="px;"),t=t+o+":"+n+i}}return t||void 0}function b(){this.__d=!0}function x(e,t){return{__v:e,context:t,props:e.props,setState:b,forceUpdate:b,__d:!0,__h:new Array(0)}}var k,w,C,S,A=function(){var e=this;this.promise=new Promise(function(t,r){e.resolve=t,e.reject=r})},E={},T=[],L=Array.isArray,j=Object.assign,P="",F="\x3c!--$s--\x3e",W="\x3c!--/$s--\x3e";function D(e,n,o){var i=t.options[r];t.options[r]=!0,k=t.options.__b,w=t.options.diffed,C=t.options.__r,S=t.options.unmount;var a=t.h(t.Fragment,null);a.__k=[e];try{var s=$(e,n||E,!1,void 0,a,!1,o);return L(s)?s.join(P):s}catch(e){if(e.then)throw new Error('Use "renderToStringAsync" for suspenseful rendering.');throw e}finally{t.options.__c&&t.options.__c(e,T),t.options[r]=i,T.length=0}}function N(e,t){var r,o=e.type,a=!0;return e[n]?(a=!1,(r=e[n]).state=r[i]):r=new o(e.props,t),e[n]=r,r.__v=e,r.props=e.props,r.context=t,p(r),null==r.state&&(r.state=E),null==r[i]&&(r[i]=r.state),o.getDerivedStateFromProps?r.state=j({},r.state,o.getDerivedStateFromProps(r.props,r.state)):a&&r.componentWillMount?(r.componentWillMount(),r.state=r[i]!==r.state?r[i]:r.state):!a&&r.componentWillUpdate&&r.componentWillUpdate(),C&&C(e),r.render(r.props,r.state,t)}function $(e,r,o,h,m,g,_){if(null==e||!0===e||!1===e||e===P)return P;var b=typeof e;if("object"!=b)return"function"==b?P:"string"==b?v(e):e+P;if(L(e)){var A,T=P;m.__k=e;for(var D=e.length,Z=0;Z<D;Z++){var q=e[Z];if(null!=q&&"boolean"!=typeof q){var R,H=$(q,r,o,h,m,g,_);"string"==typeof H?T+=H:(A||(A=new Array(D)),T&&A.push(T),T=P,L(H)?(R=A).push.apply(R,H):A.push(H))}}return A?(T&&A.push(T),A):T}if(void 0!==e.constructor)return P;e.__=m,k&&k(e);var z=e.type,I=e.props;if("function"==typeof z){var B,O,V,K=r;if(z===t.Fragment){if("tpl"in I){for(var G=P,J=0;J<I.tpl.length;J++)if(G+=I.tpl[J],I.exprs&&J<I.exprs.length){var Q=I.exprs[J];if(null==Q)continue;"object"!=typeof Q||void 0!==Q.constructor&&!L(Q)?G+=Q:G+=$(Q,r,o,h,e,g,_)}return G}if("UNSTABLE_comment"in I)return"\x3c!--"+v(I.UNSTABLE_comment)+"--\x3e";O=I.children}else{if(null!=(B=z.contextType)){var X=r[B.__c];K=X?X.props.value:B.__}var Y=z.prototype&&"function"==typeof z.prototype.render;if(Y)O=/**#__NOINLINE__**/N(e,K),V=e[n];else{e[n]=V=/**#__NOINLINE__**/x(e,K);for(var ee=0;d(V)&&ee++<25;){f(V),C&&C(e);try{O=z.call(V,I,K)}catch(t){throw g&&t&&"function"==typeof t.then&&(e._suspended=!0),t}}p(V)}if(null!=V.getChildContext&&(r=j({},r,V.getChildContext())),Y&&t.options.errorBoundaries&&(z.getDerivedStateFromError||V.componentDidCatch)){O=null!=O&&O.type===t.Fragment&&null==O.key&&null==O.props.tpl?O.props.children:O;try{return $(O,r,o,h,e,g,!1)}catch(a){return z.getDerivedStateFromError&&(V[i]=z.getDerivedStateFromError(a)),V.componentDidCatch&&V.componentDidCatch(a,E),d(V)?(O=N(e,r),null!=(V=e[n]).getChildContext&&(r=j({},r,V.getChildContext())),$(O=null!=O&&O.type===t.Fragment&&null==O.key&&null==O.props.tpl?O.props.children:O,r,o,h,e,g,_)):P}finally{w&&w(e),S&&S(e)}}}O=null!=O&&O.type===t.Fragment&&null==O.key&&null==O.props.tpl?O.props.children:O;try{var te=$(O,r,o,h,e,g,_);return w&&w(e),t.options.unmount&&t.options.unmount(e),e._suspended?"string"==typeof te?F+te+W:L(te)?(te.unshift(F),te.push(W),te):te.then(function(e){return F+e+W}):te}catch(n){if(!g&&_&&_.onError){var re=function t(n){return _.onError(n,e,function(e,n){try{return $(e,r,o,h,n,g,_)}catch(e){return t(e)}})}(n);if(void 0!==re)return re;var ne=t.options.__e;return ne&&ne(n,e),P}if(!g)throw n;if(!n||"function"!=typeof n.then)throw n;return n.then(function t(){try{var n=$(O,r,o,h,e,g,_);return e._suspended?F+n+W:n}catch(e){if(!e||"function"!=typeof e.then)throw e;return e.then(t)}})}}var oe,ie="<"+z,ae=P;for(var se in I){var ce=I[se];if("function"!=typeof(ce=U(ce)?ce.value:ce)||"class"===se||"className"===se){switch(se){case"children":oe=ce;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in I)continue;se="for";break;case"className":if("class"in I)continue;se="class";break;case"defaultChecked":se="checked";break;case"defaultSelected":se="selected";break;case"defaultValue":case"value":switch(se="value",z){case"textarea":oe=ce;continue;case"select":h=ce;continue;case"option":h!=ce||"selected"in I||(ie+=" selected")}break;case"dangerouslySetInnerHTML":ae=ce&&ce.__html;continue;case"style":"object"==typeof ce&&(ce=y(ce));break;case"acceptCharset":se="accept-charset";break;case"httpEquiv":se="http-equiv";break;default:if(s.test(se))se=se.replace(s,"$1:$2").toLowerCase();else{if(a.test(se))continue;"-"!==se[4]&&!u.has(se)||null==ce?o?l.test(se)&&(se="panose1"===se?"panose-1":se.replace(/([A-Z])/g,"-$1").toLowerCase()):c.test(se)&&(se=se.toLowerCase()):ce+=P}}null!=ce&&!1!==ce&&(ie=!0===ce||ce===P?ie+" "+se:ie+" "+se+'="'+("string"==typeof ce?v(ce):ce+P)+'"')}}if(a.test(z))throw new Error(z+" is not a valid HTML tag name in "+ie+">");if(ae||("string"==typeof oe?ae=v(oe):null!=oe&&!1!==oe&&!0!==oe&&(ae=$(oe,r,"svg"===z||"foreignObject"!==z&&o,h,e,g,_))),w&&w(e),S&&S(e),!ae&&M.has(z))return ie+"/>";var le="</"+z+">",ue=ie+">";return L(ae)?[ue].concat(ae,[le]):"string"!=typeof ae?[ue,ae,le]:ue+ae+le}var M=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]);function U(e){return null!==e&&"object"==typeof e&&"function"==typeof e.peek&&"value"in e}function Z(e,t){return'<preact-island hidden data-target="'+e+'">'+t+"</preact-island>"}var q=function e(t){try{var r=function(){if(t.suspended.length>0){var r=[].concat(t.suspended);return Promise.resolve(Promise.all(t.suspended.map(function(e){return e.promise}))).then(function(){return t.suspended=t.suspended.filter(function(e){return!r.includes(e)}),Promise.resolve(e(t)).then(function(){})})}}();return Promise.resolve(r&&r.then?r.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},R=function(e,t){var r=t.context,n=t.onWrite,o=t.abortSignal;try{r=r||{};var i={start:Date.now(),abortSignal:o,onWrite:n,onError:H,suspended:[]},a=D(e,r,i);n(a);var s=i.suspended.length,c=function(){if(s>0)return n("<div hidden>"),n('<script>(function(){class e extends HTMLElement{connectedCallback(){var e=this;if(!e.isConnected)return;let t=this.getAttribute("data-target");if(t){for(var r,a,i=document.createNodeIterator(document,128);i.nextNode();){let e=i.referenceNode;if(e.data=="preact-island:"+t?r=e:e.data=="/preact-island:"+t&&(a=e),r&&a)break}r&&a&&requestAnimationFrame((()=>{for(var t=a.previousSibling;t!=r&&t&&t!=r;)a.parentNode.removeChild(t),t=a.previousSibling;for(i=r;e.firstChild;)r=e.firstChild,e.removeChild(r),i.after(r),i=r;e.parentNode.removeChild(e)}))}}}customElements.define("preact-island",e);}())<\/script>'),Promise.resolve(q(i)).then(function(){n("</div>")})}();return Promise.resolve(c&&c.then?c.then(function(){}):void 0)}catch(e){return Promise.reject(e)}};function H(e,t,r){var o=this;if(e&&e.then){for(;t=t.__;){var i=t[n];if(i&&i.__c)break}if(t){var a=t.__v,s=this.suspended.find(function(e){return e.id===a}),c=new A,l=this.abortSignal;l&&(l.aborted?c.resolve():l.addEventListener("abort",c.resolve));var u=e.then(function(){if(!l||!l.aborted){var e=r(t.props.children,t);e&&o.onWrite(Z(a,e))}},this.onError);this.suspended.push({id:a,vnode:t,promise:Promise.race([u,c.promise])});var p=r(t.props.fallback);return s?"":"\x3c!--preact-island:"+a+"--\x3e"+p+"\x3c!--/preact-island:"+a+"--\x3e"}}}e.renderToReadableStream=function(e,t){var r=new A,n=new TextEncoder("utf-8"),o=new ReadableStream({start:function(o){R(e,{context:t,onError:function(e){r.reject(e),o.abort(e)},onWrite:function(e){o.enqueue(n.encode(e))}}).then(function(){o.close(),r.resolve()}).catch(function(e){o.error(e),r.reject(e)})}});return o.allReady=r.promise,o}});
//# sourceMappingURL=index.umd.js.map
